<script>
	  document.getElementById('idCB').readOnly = true;
    document.getElementById('idCBOU').readOnly = true;
    document.getElementById('idCBRecent').readOnly = true;
    document.getElementById('idCBstatus').readOnly = true;
    document.getElementById('idCBlastsync').readOnly = true;
    document.getElementById('idCBosversion').readOnly = true;
    document.getElementById('idCBasset').readOnly = true;
    document.getElementById('idCBuser').readOnly = true;
    document.getElementById('idCBnote').readOnly = true;
    document.getElementById('idCBmacAddress').readOnly = true;
    document.getElementById('idCBOUautoUpdateExpiration').readOnly = true;
    document.getElementById('idCBRecent').readOnly = true;
    document.getElementById('idCBRecentUsers0').readOnly = true;

    document.getElementById("btnserno").addEventListener("click",fetchCBOU);
    function fetchCBOU(){
        var sernum = document.getElementById("serial").value;
        // console.log(sernum);
        google.script.run
        .withSuccessHandler(printCBOU)
        .findCBOU(sernum);
        document.getElementById("serial").value = "";
    }

        window.printCBOU = function(CBOU) {
        document.getElementById('idCB').value = CBOU[0];
        document.getElementById('idCBOU').value = CBOU[1];
        document.getElementById('idCBstatus').value = CBOU[2];
        document.getElementById('idCBlastsync').value = CBOU[3];
        document.getElementById('idCBosversion').value = CBOU[4];
        document.getElementById('idCBasset').value = CBOU[5];
        document.getElementById('idCBuser').value = CBOU[6];
        document.getElementById('idCBnote').value = CBOU[7];
        document.getElementById('idCBmacAddress').value = CBOU[8];
        document.getElementById('idCBOUautoUpdateExpiration').value = CBOU[9];
        document.getElementById('idCBRecent').value = CBOU[10];
        
        // console.log('Device info: ' + CBOU);

        var list0 = CBOU[11];
        console.log('list0 is array ' + Array.isArray(list0));
        // console.log(list0);
        // console.log(list0.length);
        for (i=0; i<list0.length; i++) {
          // console.log(i);
          var user0 = list0[i].email;
          // console.log(user0);
          var type0 = list0[i].type;
          // console.log(type0);
        let html0='<style>td,th{border:0px solid black;}</style><table>';
        html0+='<tr><td>' + user0 + '</td></tr>';
        html0+='</table>';
        var myTable0 = document.getElementById("idCBRecentUsers0");
        myTable0.insertAdjacentHTML("beforeend", html0);
        }
    }
</script>
